(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{192:function(t,s,e){"use strict";e.r(s);var a=e(0),n=Object(a.a)({},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"ðŸ“¦-microservices-and-docker"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ðŸ“¦-microservices-and-docker","aria-hidden":"true"}},[t._v("#")]),t._v(" ðŸ“¦ Microservices and Docker")]),t._v(" "),e("h2",{attrs:{id:"microservices"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#microservices","aria-hidden":"true"}},[t._v("#")]),t._v(" Microservices")]),t._v(" "),e("p",[t._v("Micro services are small dedicated services that concentrate on solving one problem in a domain. The idea is to break apart your monolith (a place where all your services live) into small independent services. Let's talk about the PROs and CONs of this approach")]),t._v(" "),e("p",[e("strong",[t._v("PROs")])]),t._v(" "),e("ul",[e("li",[e("strong",[t._v("Can be developed and deployed independently")]),t._v(", deploying a Monolith app can take some time. A lot of developers working in the same codebase can make for complicated merges. With micro services all of that goes away, dedicated repos for each micro service. You can spin up or redeploy your service without spinning up a large machinery.")]),t._v(" "),e("li",[e("strong",[t._v("Different teams can work on different services")]),t._v(", it becomes so much easier to scale up your IT operation with one team per micro service.")]),t._v(" "),e("li",[e("strong",[t._v("Different services can be built in different programming languages")]),t._v(", your company no longer need to have "),e("em",[t._v("one")]),t._v(" tech stack. With this degree of freedom this means that the developers you hire can use their favorite tools and programming language to build the service.")]),t._v(" "),e("li",[e("strong",[t._v("Easy to scale")]),t._v(" with an orchestrator like Kubernetes, because micro services are turning into containers it becomes really easy to scale up the number of Micro service instances that are needed to meet your user demands like a big sale or similar. Thanks to Kubernetes this is quite easy.")])]),t._v(" "),e("p",[e("strong",[t._v("CONs")])]),t._v(" "),e("ul",[e("li",[t._v("you need to learn about containers cause that's how you usually serve up your micro services")]),t._v(" "),e("li",[t._v("orchestration becomes a problem you need to manage, you need to find a way to easily create containers, bring them up, bring the down")]),t._v(" "),e("li",[t._v("talking cross services is a thing you will need to manage")]),t._v(" "),e("li",[t._v("it takes a while to mentally learn to architect and "),e("em",[t._v("think")]),t._v(" in micro services")])]),t._v(" "),e("h2",{attrs:{id:"docker"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker","aria-hidden":"true"}},[t._v("#")]),t._v(" Docker")]),t._v(" "),e("p",[t._v("Docker helps us create containers out of our micro services. Once our micro services are being served up as container we can push them to container registry in the Cloud. Thereafter we can have our Cloud Provider instantiate an app service from our container OR we can tell an orchestrator like Kubernetes to scale up our app in "),e("em",[t._v("n")]),t._v(" instances so we can serve millions of customers.")]),t._v(" "),e("p",[t._v("To be able to work efficiently with Docker in this workshop, we will learn the following concepts:")]),t._v(" "),e("ul",[e("li",[e("strong",[t._v("Dockerfile")]),t._v(", a docker file is a recipe for what you are about to build. The file contains information such as what OS to base your image on, dependencies that needs to be installed and of course information on how to copy and run your app within the container.")]),t._v(" "),e("li",[e("strong",[t._v("container")]),t._v(", a container is a runnable black box that only has the fraction the size a VM has. The reason for that is that the container talks to the host OS instead of having a full OS inside of the container.")]),t._v(" "),e("li",[e("strong",[t._v("image")]),t._v(", an image is what you get when you build an artifact from a Dockerfile. An image isn't runnable and needs to b converted to a container first")]),t._v(" "),e("li",[e("strong",[t._v("docker-compose")]),t._v(", docker-compose is a tool you use when you need to manage several containers at once. Without it, you would have to resort to adding creation, setup, teardown commands for each container, that means a lot of scripts and simply becomes hard to manage")])]),t._v(" "),e("h2",{attrs:{id:"what-we-will-build"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#what-we-will-build","aria-hidden":"true"}},[t._v("#")]),t._v(" What we will build")]),t._v(" "),e("p",[t._v("We will build two different micro services, giving us products and reviews respectively.")]),t._v(" "),e("p",[t._v("For each service we will take the following steps:")]),t._v(" "),e("ul",[e("li",[e("strong",[t._v("Create")]),t._v(" a REST Service in Node.js + Express")]),t._v(" "),e("li",[e("strong",[t._v("Define")]),t._v(" a Dockerfile, we need one Dockerfile for each service")]),t._v(" "),e("li",[e("strong",[t._v("Containerize")]),t._v(", we will create an image and container respectively, using docker-compose, so we have each container up and running and reachable from a browser")])]),t._v(" "),e("h3",{attrs:{id:"create-a-rest-service-in-net-core"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#create-a-rest-service-in-net-core","aria-hidden":"true"}},[t._v("#")]),t._v(" Create a REST Service in .NET Core")]),t._v(" "),e("p",[t._v("We will create two different services")]),t._v(" "),e("ul",[e("li",[e("code",[t._v("products service")]),t._v(", this will return a list of product")]),t._v(" "),e("li",[e("code",[t._v("reviews service")]),t._v(", this will contain info on a review and link to an id for a product")])]),t._v(" "),e("p",[e("strong",[t._v("Products service")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("dotnet new webapi -o products --no-https\n")])])]),e("p",[t._v("Add the file "),e("code",[t._v("DefaultController.cs")]),t._v(" to directory "),e("code",[t._v("Controllers")]),t._v(" and give it the following content:")]),t._v(" "),e("div",{staticClass:"language-csharp extra-class"},[e("pre",{pre:!0,attrs:{class:"language-csharp"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" System"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" System"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Collections"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Generic"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" System"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Linq"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" System"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Threading"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Tasks"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" Microsoft"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("AspNetCore"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Mvc"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" Microsoft"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Extensions"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Logging"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("namespace")]),t._v(" products"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Controllers\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Product")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" Id "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("get")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("string")]),t._v(" Name "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("get")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ProductsStore")]),t._v(" \n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" List"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Product"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Products "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token generic-method"}},[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("List")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Product")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Product")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        Id "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        Name "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Avengers - End Game"')]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ApiController")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DefaultController")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ControllerBase")]),t._v(" \n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Route")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" List"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Product"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("GetProducts")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" ProductsStore"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Products"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("p",[t._v("Try it out by running "),e("code",[t._v("dotnet run")]),t._v(" in the terminal. Go to a browser at "),e("code",[t._v("http://localhost:5000")]),t._v(". This should show a list of products.")]),t._v(" "),e("p",[t._v("Bring down the server with "),e("code",[t._v("CTRL+C")]),t._v(".")]),t._v(" "),e("p",[e("strong",[t._v("Reviews service")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("dotnet new webapi -o reviews --no-https\n")])])]),e("p",[t._v("Add the file "),e("code",[t._v("DefaultController.cs")]),t._v(" to directory "),e("code",[t._v("Controllers")]),t._v(" and give it the following content:")]),t._v(" "),e("div",{staticClass:"language-csharp extra-class"},[e("pre",{pre:!0,attrs:{class:"language-csharp"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" System"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" System"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Collections"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Generic"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" System"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Linq"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" System"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Threading"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Tasks"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" Microsoft"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("AspNetCore"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Mvc"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),t._v(" Microsoft"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Extensions"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Logging"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("namespace")]),t._v(" reviews"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Controllers\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Review")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" Grade "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("get")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("string")]),t._v(" Title "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("get")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("string")]),t._v(" Description "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("get")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" Product "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("get")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("set")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ReviewsStore")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" List"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Review"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Reviews "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token generic-method"}},[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("List")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Review")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Review")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        Grade "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        Title "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Great movie"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        Description "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Great actor playing Thanos"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        Product "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ApiController")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DefaultController")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ControllerBase")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Route")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" List"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Review"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("GetReviews")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" ReviewsStore"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Reviews"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("p",[t._v("Try it out by running "),e("code",[t._v("dotnet run")]),t._v(" in the terminal. Go to a browser at "),e("code",[t._v("http://localhost:5000")]),t._v(". This should show a list of products.")]),t._v(" "),e("p",[t._v("Bring down the server with "),e("code",[t._v("CTRL+C")]),t._v(".")]),t._v(" "),e("h3",{attrs:{id:"define-a-dockerfile"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#define-a-dockerfile","aria-hidden":"true"}},[t._v("#")]),t._v(" Define a Dockerfile")]),t._v(" "),e("p",[t._v("We need to do this once for each service.")]),t._v(" "),e("p",[e("strong",[t._v("Add Dockerfile to Products service")])]),t._v(" "),e("p",[t._v("Go to our "),e("code",[t._v("products")]),t._v(" directory and create a file called "),e("code",[t._v("Dockerfile")]),t._v(".")]),t._v(" "),e("p",[t._v("Give it the following content:")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v('# Dockerfile\n\nFROM mcr.microsoft.com/dotnet/core/sdk:3.1 AS build\nWORKDIR /src\nCOPY products.csproj .\nRUN dotnet restore\nCOPY . .\nRUN dotnet publish -c release -o /app\n\nFROM mcr.microsoft.com/dotnet/core/aspnet:3.1\nWORKDIR /app\nCOPY --from=build /app .\nENTRYPOINT ["dotnet", "products.dll"]\n')])])]),e("p",[e("strong",[t._v("Add Dockerfile to Reviews service")])]),t._v(" "),e("p",[t._v("Go to our "),e("code",[t._v("reviews")]),t._v(" directory and create a file called "),e("code",[t._v("Dockerfile")]),t._v(". Give it the following content:")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v('# Dockerfile\n\nFROM mcr.microsoft.com/dotnet/core/sdk:3.1 AS build\nWORKDIR /src\nCOPY reviews.csproj .\nRUN dotnet restore\nCOPY . .\nRUN dotnet publish -c release -o /app\n\nFROM mcr.microsoft.com/dotnet/core/aspnet:3.1\nWORKDIR /app\nCOPY --from=build /app .\nENTRYPOINT ["dotnet", "reviews.dll"]\n')])])]),e("p",[e("strong",[t._v("Dockerize")])]),t._v(" "),e("p",[t._v("We've created a Dockerfile for each service. Our project structure should now look something like this:")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("products/\n  -- .net core specific files\n  Dockerfile\nreviews/\n  -- .net core specific files\n  Dockerfile\n")])])]),e("p",[t._v("Let's ensure we are at the root level and create a file called "),e("code",[t._v("docker-compose.yaml")]),t._v(". Give it the following content:")]),t._v(" "),e("div",{staticClass:"language-yaml extra-class"},[e("pre",{pre:!0,attrs:{class:"language-yaml"}},[e("code",[e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("version")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'3.3'")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("services")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" \n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("product-service")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("build")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("context")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ./products\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"8000:80"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("networks")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" \n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" microservices\n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("review-service")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("build")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("context")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ./reviews\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"8001:80"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("networks")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" microservices\n"),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("networks")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" \n  "),e("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("microservices")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n")])])]),e("p",[t._v("What the above file says is:\nFor each service:")]),t._v(" "),e("ol",[e("li",[e("strong",[t._v("run")]),t._v(" the Dockerfile listed under "),e("code",[t._v("context")])]),t._v(" "),e("li",[e("strong",[t._v("set up")]),t._v(" a connection between host system port and container port "),e("code",[t._v("<host system port>:<container port>")])]),t._v(" "),e("li",[e("strong",[t._v("put")]),t._v(" each container in network "),e("code",[t._v("microservices")])])]),t._v(" "),e("p",[t._v("Your project structure should now look like this:")]),t._v(" "),e("p",[t._v("If this IS the first time we just need to run the command:")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("docker-compose up -d\n")])])]),e("p",[t._v("This will build an image of each service, then create and run a container.")]),t._v(" "),e("p",[t._v("If this is NOT the first time, you instead run the following command:")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("docker-compose build\ndocker-compose up -d\n")])])]),e("p",[t._v("NOTE, we run "),e("code",[t._v("build")]),t._v(" command to ensure that any changes to the Dockerfile is being rebuilt into a new image.")]),t._v(" "),e("p",[t._v("This should have started all services and you should be able to reach them on "),e("code",[t._v("http://localhost:8000")]),t._v(" and "),e("code",[t._v("http://localhost:8001")]),t._v(".")]),t._v(" "),e("p",[t._v("To take down the services type (no need for that yet):")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("docker-compose down\n")])])]),e("h2",{attrs:{id:"solution"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#solution","aria-hidden":"true"}},[t._v("#")]),t._v(" Solution")]),t._v(" "),e("p",[t._v("TODO")]),t._v(" "),e("p",[e("a",{attrs:{href:"https://github.com/softchris/serverless-graphql-microservices/tree/master/part3",target:"_blank",rel:"noopener noreferrer"}},[t._v("SOLUTION workshop part 3"),e("OutboundLink")],1)])])},[],!1,null,null,null);s.default=n.exports}}]);